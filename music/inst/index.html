<!DOCTYPE html>
<html>
<head>
  <title>Mirishita Instrumentals</title>
  <meta charset="UTF-8">
  <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico"/>
  <link rel="stylesheet" type="text/css" href="./slick/slick.css">
  <style type="text/css">
    @font-face {
        font-family: Mirishita;
        src: url(./font/mirishita.ttf);
    }
  
    @font-face {
        font-family: Assistant;
        src: url(./font/assistant.ttf);
    }
    
	html, body {
	    font-family: Assistant;
        margin: 0;
        padding: 0;
		text-align: center;
		background-color: #FDFDFD;
    }

    * {
        box-sizing: border-box;
    }
	
    .slider {
        width: 100%;
        padding-top: 5%;
    }
	
	.spacer {
		border-radius:0 0 100% 100%;
        margin-top: -5%;
        padding-bottom: 10%;
	}
	
	.all {
	    background: linear-gradient(to right, #F3F27C , #CAE9B4, #96D8EC, #BDD0EC, #F2B7E0, #BDD0EC, #96D8EC, #CAE9B4, #F3F27C);
	}
	
	.princess {
	    background: linear-gradient(to right, #E7B3A4 , #D8949F, #E690BA, #D8949F, #E7B3A4);
	}
	
	.fairy {
	    background: linear-gradient(to right, #90E8EF , #70B8DE, #6A9FEF, #70B8DE, #90E8EF);
	}
	
	.angel {
	    background: linear-gradient(to right, #D5F178 , #D7D26A, #E9CB73, #D7D26A, #D5F178);
	}
	
    .slick-slide img {
      width: 100%;
    }

    .slick-prev:before,
    .slick-next:before {
      color: black;
    }

    .slick-slide {
      transition: all ease-in-out .3s;
	  filter: brightness(50%);
      transform: scale(.8) translateY(-12.5%);
    }

    .slick-current {
      transform: none;
	  filter: brightness(100%);
    }
	
	.nowplaying {
		margin-top: 1%;
		margin-left: 1%;
	    z-index: 1;
		position: relative;
	    float: left;
	    font-family: Assistant;
		font-size: 2vw;
	}
	
	.songname {
		margin-top: 1%;
	    font-family: Mirishita;
	    margin-left: 15.4%;
	    text-align: left;
		font-size: 3vw;
		line-height: 2.5ex;
		margin-bottom: 1%;
	}
	
	.button {
	    width: 19%;
	    font-family: Assistant;
		text-align: center;
        margin: 0% 3%;
		padding-top: 0.8%;
		padding-bottom: 0.8%;
		text-decoration: none;
		display: inline-block;
		font-size: 2.4vw;
		border-radius:5em;
		border: black;
		border-style: solid;
		border-width: thin;
	}
	
	.redbutton {
		color: white;
	    background: linear-gradient(to right, #FF7B9E , #FF3F3F);
	}
	
	.redbutton:active {
	    background: linear-gradient(to right, #E15D80 , #E12020);
	}
	
	.whitebutton {
		color: black;
	    background: linear-gradient(to right, #FFFFFF , #DDE5F5);
	}
	
	.whitebutton:active {
	    background: linear-gradient(to right, #E1E1E1 , #BFC7D7);
	}
	
	.volume-slider {
	    width: 100%;
		padding-top: 1.3%;
		text-align: center;
		color: black;
		display: inline-block;
		font-size: 1.8vw;
		text-decoration: none;
	}
	
	input[type=range] {
	    -webkit-appearance: none;
		appearance: none;
	    width: 69.3%;
		border-radius:5em;
		background: #d3d3d3;
		outline: none;
		opacity: 0.7;
		transition: opacity .2s;
	}
	
	input[type=range]::-moz-range-track {
		padding: 1.5% 0%;
		border-radius:5em;
		background: #d3d3d3;
	}
	
	input[type=range]::-ms-track {
		height: 0%;
		visibility: hidden;
	}

	input[type=range]:hover {
		opacity: 1;
	}
	
	input[type=range]::-webkit-slider-thumb {
	    -webkit-appearance: none;
		border: 1px solid #000000;
		padding: 1.45% 0%;
		height: 100%;
		width: 3%;
		border-radius:5em;
	    background: linear-gradient(to right, #FFFFFF , #DDE5F5);
		cursor: pointer;
		margin-top: 0%;
	}

	input[type=range]::-moz-range-thumb {
	    appearance: none;
		border: 1px solid #000000;
		padding: 0.9% 0%;
		height: 100%;
		width: 3%;
		border-radius:5em;
	    background: linear-gradient(to right, #FFFFFF , #DDE5F5);
		cursor: pointer;
	}

	input[type=range]::-ms-thumb {
		border: 1px solid #000000;
		padding: 100% 100%;
		height: 100%;
		width: 100%;
		border-radius:5em;
	    background: linear-gradient(to right, #FFFFFF , #DDE5F5);
		cursor: pointer;
	}
  </style>
</head>
<body>
  <div class="nowplaying" id="np"></div>
  <div class="slider" id="slickslider"></div>
  <div class="spacer" id="spacer"></div>
  <div class="songname"></div>
    <button class="button redbutton" onclick="Play()">Play</button><button class="button whitebutton" onclick="Stop()">Stop</button><a id="mp3link" href="./mp3/bgm_inst_bnthtr.mp3"><button class="button whitebutton">Download</button></a><br>
  <div class="volume-slider">
    Volume<br>
    <input id="volslider" class="input" type="range" min="0" max="100.0" step=".1" value="100" oninput="SetVolume(this.value)" onchange="SetVolume(this.value)"></input>
  </div>
   
  <script src="https://code.jquery.com/jquery-2.2.0.min.js" type="text/javascript"></script>
  <script src="./slick/slick.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">

if (!Array.prototype.includes) {
    Object.defineProperty(Array.prototype, "includes", {
        enumerable: false,
        value: function(obj) {
            var newArr = this.filter(function(el) {
                return el == obj;
            });
            return newArr.length > 0;
        }
    });
}

function addColor(songtype)
{
	$("#slickslider").addClass(songtype);
	$("#spacer").addClass(songtype);
}

function removeColor(songtype)
{
	$("#slickslider").removeClass(songtype);
	$("#spacer").removeClass(songtype);
}

var aud = document.createElement("AUDIO");
aud.volume = Math.pow($("#volslider").val() / 100, 2.0);
aud.onended = function() {
    $("#np").html("");
};

var songdata;

$(document).on('ready', function() {
	$.getJSON("./songs.json", function(json) {
		songdata = json.songs;
		var generatedhtml = "";
		$.each(songdata, function(i, data) {
			generatedhtml += '<div><img src="./jacket/jacket_' + data.name + '.png"></div>';
		});
		$("#slickslider").html(generatedhtml);
		$(".songname").html(songdata[0].longname);
		addColor(songdata[0].type);
		$(".slider").slick({
			dots: false,
			infinite: true,
			centerMode: true,
			slidesToShow: 5,
			swipeToSlide: true,
			arrows: false,
			touchThreshold: 15
		});
	});
});

$('.slider').on('click', '.slick-slide', function (e) {
	e.stopPropagation();
	var index = $(this).data("slick-index");
	if ($('.slider').slick('slickCurrentSlide') !== index) {
	    $('.slider').slick('slickGoTo', index);
	}
});

$('.slider').on('beforeChange', function (e, slick, currSlide, nextSlide) {
	removeColor(songdata[currSlide].type);
	addColor(songdata[nextSlide].type);
	$(".songname").html(songdata[nextSlide].longname);
	$("#mp3link").attr("href", "./mp3/bgm_inst_" + songdata[nextSlide].name + ".mp3");
});
	
function Play() {
    aud.setAttribute("src","./mp3/bgm_inst_" + songdata[$('.slider').slick('slickCurrentSlide')].name + ".mp3");
	aud.play();
	$("#np").html("â–¶ Now Playing: " + songdata[$('.slider').slick('slickCurrentSlide')].longname);
}

function Stop() {
    aud.pause();
	$("#np").html("");
}

function SetVolume(vol)
{
    aud.volume = Math.pow(vol / 100, 2.0);
}

</script>

</body>
</html>
